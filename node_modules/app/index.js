'use strict';
var OptionsStrategy = require('app/OptionsStrategy');
var BlackScholes = require('app/BlackScholes');

module.exports = function(portfolio,S,Tmt) {
// portfolio: [{q: 1, t:'P', X:80, r:0, v:0.25, T:0, V:2.12}]
// S: 60 or [60,80,100,120]
// Tmt: 0 or [0,0.1,0.2]
  try {
    var p2 = portfolio.map(function(x) {
      return {
        q: x.q,
        o: new BlackScholes(
          x.t, x.X, x.r, x.v, x.T,
          x.hasOwnProperty("V")?x.V:undefined
        )
      };
    });
    var bs1=new OptionsStrategy(p2);
    var x=bs1.margin(S,Tmt);
    return x;
  } catch(ex) {
    if(ex.hasOwnProperty("message")) ex = ex.message;
    console.log(ex);
  }
};
